define("modules/clean/open_in_app/actions",["require","exports","tslib","modules/clean/open_in_app/types","modules/clean/open_in_mobile_app"],(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.openInApp=function(e,t){var r,a=t.onAppNeeded,o=t.onAppInstalled;i.areUrlsIOS(e)?n.default.open_ios(e.iOSAppUrl,e.iOSAppStoreUrl,!(r=(navigator.userAgent||"").match(/OS (\d+)_(\d+)_?(\d+)?/))||parseInt(r[1],10)>=9,a,o):i.areUrlsAndroid(e)&&n.default.open_android_intent(e.androidAppUrl)},t.openImmediately=function(e){var t;if(i.areUrlsIOS(e))t=e.iOSAppUrl;else{if(!i.areUrlsAndroid(e))return;t=e.androidAppUrl}var r=document.createElement("iframe");r.setAttribute("class","open-in-app-transport"),r.setAttribute("src",t),r.setAttribute("style","display: none"),document.body.appendChild(r)},t.cleanUp=function(){n.default.cleanup()}})),define("modules/clean/open_in_mobile_app",["require","exports","tslib","jquery","modules/clean/analytics","modules/core/exception","modules/core/i18n","modules/clean/sharing/constants"],(function(e,t,r,i,n,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importStar(n);var l=(function(){function e(){}return e.initClass=function(){var e=this;this.vischange_listener=null,this.open_app_mode=!0,this.try_open_ios_9=function(t,r,i,n){return void 0===i&&(i=function(){}),void 0===n&&(n=function(){}),e.vischange_listener||(e.vischange_listener=function(t){return e.open_app_mode=!0,n()},document.addEventListener("visibilitychange",e.vischange_listener)),e.open_app_mode?(e.open_app_mode=!1,e._onOpenLoggingHandler(),i(),window.location=t):(e._onInstallLoggingHandler(),window.location=r)},this.fallback_will_launch=!1,this.try_open=function(t,r,a){if(e._onOpenLoggingHandler(),!e.fallback_will_launch){var o=i.default("body"),l=!1,c=function(e){return l=!0};document.addEventListener("visibilitychange",c);var u,d=!1,p=function(e){return d=!0};window.addEventListener("pagehide",p),null!=a&&n.ShareTibEventLogger.log_unauth("CLICK_MOBILE_OPEN",s.SHARE_ACTION_ORIGIN_TYPE.WEB_MOBILE,{scl_url:a}),u=i.default("<iframe />",{src:t,style:"display: none;"}),o.append(u);var f=Date.now();return setTimeout((function(){if(e.fallback_will_launch=!1,document.removeEventListener("visibilitychange",c),window.removeEventListener("pagehide",p),!d&&!l&&Date.now()<f+4700)return null!=a&&n.ShareTibEventLogger.log_unauth("CLICK_MOBILE_INSTALL",s.SHARE_ACTION_ORIGIN_TYPE.WEB_MOBILE,{scl_url:a}),window.location.replace(r)}),3200),e.fallback_will_launch=!0}}},e._onOpenLoggingHandler=function(){},e._onInstallLoggingHandler=function(){},e.registerLoggingHandlers=function(e,t){return this._onOpenLoggingHandler=e,this._onInstallLoggingHandler=t},e.open_on_click=function(e,t,r,n,a,s,l){var c=this;void 0===s&&(s=null);return i.default(r).on("click",(function(r){if(r.preventDefault(),l)return c.open_android_intent(l);if(a){n||(n=i.default("<div/>"));var u=n.text();return c.try_open_ios_9(e,t,(function(){return n.text(o._("Install app?"))}),(function(){return n.text(u)}))}return c.try_open(e,t,s)}))},e.open_ios=function(e,t,r,i,n){return void 0===i&&(i=function(){}),void 0===n&&(n=function(){}),r?this.try_open_ios_9(e,t,i,n):this.try_open(e,t)},e.open_android_intent=function(e){return a.assert(e&&e.startsWith("intent://www.dropbox.com/sm/launch_intent_or_fallback_page"),"intentUrl must use intent:// protocol"),this._onOpenLoggingHandler&&this._onOpenLoggingHandler(),window.location.href=e},e.redirect_on_load=function(e,t){return this.try_open(e,t)},e.cleanup=function(){if(this.vischange_listener)return document.removeEventListener("visibilitychange",this.vischange_listener)},e})();l.initClass(),t.default=l})),define("modules/clean/react/file_viewer/controller_mode",["require","exports","modules/clean/api_v2/noauth_client","modules/clean/api_v2/user_client"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchControllerMode=function(e,t){return null!=t?(function(e,t){return(new i.UserApiV2Client).ns("file_viewer").rpc("get_mode",e,{subjectUserId:t.id})})(e,t):(function(e){return(new r.NoAuthApiV2Client).ns("file_viewer").rpc("logged_out/get_mode",e,{})})(e)}})),define("modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial",["require","exports","tslib","classnames","react","spectrum/button","spectrum/file_icon","spectrum/icon_content","spectrum/icon_form","modules/clean/open_in_app/types","modules/clean/static_urls","modules/core/i18n","modules/clean/react/css"],(function(e,t,r,i,n,a,o,s,l,c,u,d,p){"use strict";function f(e){var t=e.onClose;return n.default.createElement("header",null,n.default.createElement("h1",{className:"DropboxLogo"},n.default.createElement("img",{src:u.static_url("/static/images/index/rebrand/logos/glyphs/glyph_blue-vfla3iXuq.svg"),className:"DropboxLogo--glyph",alt:"Dropbox"}),n.default.createElement("img",{src:u.static_url("/static/images/index/rebrand/logos/wordmarks/wordmark_black-vflmhE3RY.svg"),className:"Dropbox--wordmark",alt:"Dropbox"})),n.default.createElement("button",{className:"button-as-link app-download-interstitial-close","aria-label":"Close",onClick:t},n.default.createElement(l.IconForm,{name:"cancel"})))}function m(e){var t=e.appUrl,r=e.onContinue,i=e.onAppDownload;return n.default.createElement("div",{className:"app-download-interstitial-ctas"},n.default.createElement(a.Button,{className:"app-download-interstitial-cta",size:"large",href:t,onClick:i},d._("Get the app")),n.default.createElement(a.Button,{className:"app-download-interstitial-cta",size:"large",variant:"secondary",onClick:r},d._("Or continue to website")))}function _(e){var t,r,i=e.fileOrFolderName,a=e.isFolder,l=e.ownerName,c=e.ownerTeamName;return n.default.createElement("section",{className:"app-download-interstitial-content"},n.default.createElement("header",null,n.default.createElement("h2",null,d._("Get a better view with our mobile app"))),n.default.createElement("div",{className:"app-download-interstitial-content-thumbnail"},a?n.default.createElement(s.IconContent,{name:"folder_shared-large"}):n.default.createElement(o.FileIcon,{path:i,variant:"large"}),n.default.createElement("p",{className:"app-download-interstitial-filename"},i),n.default.createElement("p",{className:"app-download-interstitial-owner"},(r=c,(t=l)&&r?d._("%(owner)s (%(team)s) shared this with you.").format({owner:t,team:r}):t&&!r?d._("%(owner)s shared this with you.").format({owner:t}):!t&&r?d._("%(team)s shared this with you.").format({team:r}):d._("This file was shared with you.")))))}function g(e){if(e){if(c.areUrlsIOS(e))return e.iOSAppStoreUrl;if(c.areUrlsAndroid(e))return e.androidAppUrl}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importDefault(n);var v=p.requireCssWithComponent((function(e){var t=e.className,r=e.open_in_app_data,a=e.fileOrFolderName,o=e.isFolder,s=e.onClose,l=e.onContinue,c=e.onAppDownload,u=e.ownerName,d=e.ownerTeamName;return n.default.createElement("section",{className:i.default("app-download-interstitial-container",t)},n.default.createElement(f,{onClose:s}),n.default.createElement(_,{isFolder:o,fileOrFolderName:a,ownerName:u,ownerTeamName:d}),n.default.createElement(m,{onContinue:l,onAppDownload:c,appUrl:g(r)}))}),["/static/css/index/obsidian/logo-vflwvo1dq.css","/static/css/file_viewer/app_download_interstitial-vfltlXZTJ.css"]);t.AppDownloadInterstitial=v})),define("modules/clean/react/file_viewer/data/actions",["require","exports","tslib","modules/clean/ajax","modules/clean/react/file_viewer/constants","modules/clean/file_store/actions","modules/clean/previews/data/actions","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/data/selectors","modules/clean/file_store/utils","modules/clean/react/file_viewer/data/types","modules/clean/previews/data/util","modules/clean/react/file_viewer/constants","modules/clean/downloads","modules/core/uri","modules/core/browser","modules/clean/react/file_viewer/controller_mode","modules/clean/react/file_viewer/models","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/watermarking/utils","file-viewer/core","modules/clean/react/workflows/markup/fabric","modules/clean/react/workflows/markup/selectors","modules/clean/react/file_viewer/prompt/campaign_api","modules/clean/react/size_class/constants","modules/clean/react/watermarking/selectors"],(function(e,t,r,i,n,a,o,s,l,c,u,d,p,f,m,_,g,v,w,h,S,b,M,E,y,A){"use strict";function T(e){return{type:u.Actions.OpenFile,payload:{fileId:e}}}function k(e){return function(t,r){var i,n=((i={})[S.FileViewerMode.Default]=N,i[S.FileViewerMode.Documentation]=z,i[S.FileViewerMode.Commenting]=H,i[S.FileViewerMode.Watermarking]=j,i[S.FileViewerMode.Zoom]=B,i[S.FileViewerMode.Slack]=K,i[S.FileViewerMode.Markup]=G,i[S.FileViewerMode.Plugins]=q,i[S.FileViewerMode.HelloSign]=X,i);n[e]&&n[e](t,r)}}function I(e){return w.filePreviewEventEmitter.emit(p.EventType.SidebarModeSelected,v.FilePreviewSession.currentSession,{selected_mode:e}),{type:u.Actions.UpdateMode,payload:{mode:e}}}function F(e){return function(t,r){var i=l.getCurrentFileId(r());i&&t((function(e,t){return{type:u.Actions.UpdateRenderStatus,payload:{fileId:e,renderStatus:t}}})(i,e))}}function C(e){return w.filePreviewEventEmitter.emit(p.EventType.SidebarPaneSelected,v.FilePreviewSession.currentSession,{selected_pane:e}),{type:u.Actions.PushSidebarPane,payload:{paneId:e}}}function O(){return{type:u.Actions.ResetSidebarPaneStack}}function P(){return{type:u.Actions.ResetSelectedSidebarControlId}}function R(e){return{type:u.Actions.SetSelectedSidebarControlId,payload:{controlId:e}}}function D(e){var t=e===S.SidebarVisibility.Open?p.EventType.SidebarOpened:p.EventType.SidebarClosed;return w.filePreviewEventEmitter.emit(t,v.FilePreviewSession.currentSession),{type:u.Actions.SetSidebarVisibility,payload:{visibility:e}}}function U(e){return function(t,r){t({type:u.Actions.UpdateWatermarkOptions,payload:{options:e}}),h.setLocalStorageWatermarkingState(l.getCurrentUser(r()),A.getWatermarkState(r()))}}function x(e){return function(t,r){t({type:u.Actions.SwitchWatermarkingMode,payload:{mode:e}}),h.setLocalStorageWatermarkingState(l.getCurrentUser(r()),A.getWatermarkState(r()))}}function L(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){var n,a;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,h.getUserMetadataTextWatermarkingState(e)];case 1:return n=o.sent(),[4,h.getLocalStorageWatermarkingState(e)];case 2:return(a=o.sent())?(U({textWatermarkingOptions:r.__assign({},a.textWatermarkingOptions,n),imageWatermarkingOptions:a.imageWatermarkingOptions})(t,i),x(a.mode)(t,i)):n?U({textWatermarkingOptions:n})(t,i):U({textWatermarkingOptions:{text:h.getDefaultText(e)}})(t,i),[2]}}))}))}function V(e){return{type:u.Actions.SetTrialMode,payload:{isTrialMode:e}}}function N(e,t){var r=t(),i=l.getMode(r);e(V(!1)),e(P()),i!==S.FileViewerMode.Default&&e(I(S.FileViewerMode.Default))}function W(e,t,r,i){return function(n,a){var o=a(),s=l.getSidebar(o).visibility,c=l.getMode(o);s===S.SidebarVisibility.Closed&&n(D(S.SidebarVisibility.Open)),c!==e&&(n(V(!!i&&i(o))),n(R(t)),n(O()),n(C(r)),n(I(e)))}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),f=r.__importStar(f),_=r.__importStar(_),t.openFullScreen=function(){return{type:u.Actions.OpenFullScreen}},t.closeFullScreen=function(){return{type:u.Actions.CloseFullScreen}},t.openSidebar=function(e,t){return void 0===e&&(e=n.DocType.default),function(r){r({type:u.Actions.OpenSidebar,payload:{type:e}}),s.logUserAction(n.UserAction.ToggleSidebarOn,t)}},t.closeSidebar=function(e,t){return void 0===e&&(e=n.DocType.default),function(r){r({type:u.Actions.CloseSidebar,payload:{type:e}}),s.logUserAction(n.UserAction.ToggleSidebarOff,t)}},t.dismissAppDownloadInterstitial=function(){return{type:u.Actions.DismissAppDownloadInterstitial}},t.openFileById=T,t.closeFile=function(){return{type:u.Actions.CloseFile}},t.changeMode=k,t.disableMode=function(e){return{type:u.Actions.DisableMode,payload:{mode:e}}},t.enableMode=function(e){return{type:u.Actions.EnableMode,payload:{mode:e}}},t.updateMode=I,t.openFile=function(e){var t=this;return function(i,n){return r.__awaiter(t,void 0,void 0,(function(){var t,s;return r.__generator(this,(function(r){return t=c.getFileStoreId(e),s=a.putFile(e),i(s),!d.previewDataPresentForFile(n(),e)&&!d.previewDataInFlight(n(),e)&&(s.payload.file.preview?i(o.populateFilesPreviewData([s.payload.file])):i(o.fetchPreviewData([s.payload.file]))),i(T(t)),[2]}))}))}},t.setRenderStatusForCurrentFile=F,t.setRenderStatusSuccessForCurrentFile=function(){return F(p.PreviewRenderStatus.Succeeded)},t.fetchShowOverQuotaUpsell=function(e){return function(t,r){e&&void 0===l.getShowOverQuotaUpsell(r())&&i.SilentBackgroundRequest({url:"/should_show_file_preview_upsell",data:{_subject_uid:e.id},success:function(e){try{var r=JSON.parse(e);r&&t((i=r.shouldShowFilePreviewUpsell,{type:u.Actions.SetShowOverQuotaUpsell,payload:i}))}catch(e){}var i}})}},t.pushSidebarPane=C,t.popSidebarPane=function(){return{type:u.Actions.PopSidebarPane}},t.resetSidebarPaneStack=O,t.resetSelectedSidebarControlId=P,t.setSelectedSidebarControlId=R,t.setSidebarVisibility=D,t.setPageDimensions=function(e){return{type:u.Actions.SetPageDimensions,payload:{pageDimensions:e}}},t.updateWatermarkOptions=U,t.switchWatermarkingMode=x,t.setMarkupCanvas=function(e,t,r){return{type:u.Actions.SetMarkupCanvas,payload:{page:e,fabric:t,scale:r}}},t.updateMarkupCanvasScale=function(e,t){return{type:u.Actions.UpdateMarkupCanvasScale,payload:{page:e,scale:t}}},t.setMarkupDrawingMode=function(e){return function(t,r){t({type:u.Actions.SetMarkupDrawingMode,payload:{isDrawingMode:e}}),b.setDrawingMode(M.getMarkupState(r()),e)}},t.setMarkupStroke=function(e){return function(t){t({type:u.Actions.SetMarkupStroke,payload:{color:e}}),b.setBaseBrushColor(e)}},t.setMarkupFill=function(e){return{type:u.Actions.SetMarkupFill,payload:{color:e}}},t.setMarkupFormatSubmenu=function(e){return{type:u.Actions.SetMarkupSubmenuType,payload:{formatSubmenu:e}}},t.resetMarkupState=function(){return function(e,t){b.disposeCanvas(M.getMarkupState(t())),e({type:u.Actions.ResetMarkupState})}},t.switchRevisionAction=function(e){return function(t){e.preview&&t(o.overridePreviewForComments(e,e.preview)),t({type:u.Actions.SwitchRevision,payload:{file:e}})}},t.restoreRevisionAction=function(){return function(e,t){var r=l.getActiveFile(t());r&&e(o.clearCommentsPreviewOverride(r)),e({type:u.Actions.RestoreRevision})}},t.saveForwardRevision=function(e){return function(t){t(a.putFile(e,e.revision_id)),e.preview&&t(o.overridePreviewForComments(e,e.preview)),t({type:u.Actions.SaveForwardRevision,payload:{revisionKey:e.revision_id}})}},t.download=function(e){var t=m.URI.parse(e.href);t.updateQuery({dl:"1"}),f.get({url:t.toString()})},t.pendingFileUploaded=function(){_.reload(!0)},t.setMediaPlaying=function(){return function(e){e({type:u.Actions.PlayMedia})}},t.setMediaPaused=function(){return function(e){e({type:u.Actions.PauseMedia})}},t.resetFileViewerStore=function(){return function(e){e({type:u.Actions.ResetStore})}},t.forceHideToolbar=function(){return{type:u.Actions.ForceHideToolbar}},t.disableForceHideToolbar=function(){return{type:u.Actions.DisableForceHideToolbar}},t.fetchControllerModeAction=function(e,t,i){var n=this;return function(a,o){return r.__awaiter(n,void 0,void 0,(function(){var n,s,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:a({type:u.Actions.FetchControllerModeRequest}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,g.fetchControllerMode(e,t)];case 2:return n=r.sent().mode,w.filePreviewEventEmitter.emit(p.EventType.FilePreviewModeDetermined,v.FilePreviewSession.currentSession,{mode:n}),i===y.SizeClass.Small||i===y.SizeClass.Medium?(a(R(S.SidebarControlId.Documentation)),a(C(S.SidebarPaneId.Documentation)),a(I(S.FileViewerMode.Documentation)),[2]):(s=(function(e){var t=S.FileViewerMode.Default;if(e)switch(e[".tag"]){case"commenting_mode":t=S.FileViewerMode.Commenting;break;case"documentation_mode":t=S.FileViewerMode.Documentation;break;case"other":t=S.FileViewerMode.Default}return t})(n),(c=l.getMode(o()))&&c!==S.FileViewerMode.Default||a(k(s)),[3,4]);case 3:return d=r.sent(),a({type:u.Actions.FetchControllerModeError,payload:d}),[3,4];case 4:return[2]}}))}))}},t.fetchBestCampaignsAction=function(e,t){var i=this;return function(n,a){return r.__awaiter(i,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,E.fetchBestCampaigns(e.id,t)];case 1:return i=r.sent().campaigns,n({type:u.Actions.SetBestCampaign,payload:{campaign:i[0]}}),[2]}}))}))}},t.updateCurrentPageIndex=function(e){return{type:u.Actions.UpdateCurrentPageIndex,payload:{currentPageIndex:e}}},t.pageDown=function(){return{type:u.Actions.PageDown}},t.pageUp=function(){return{type:u.Actions.PageUp}},t.registerUser=function(e){return function(t,r){t({type:u.Actions.RegisterUser,payload:{user:e}}),L(e,t,r)}},t.loadWatermarkingStateFromStorage=L;var z=W(S.FileViewerMode.Documentation,S.SidebarControlId.Documentation,S.SidebarPaneId.Documentation),H=W(S.FileViewerMode.Commenting,S.SidebarControlId.Comments,S.SidebarPaneId.Comments),j=W(S.FileViewerMode.Watermarking,S.SidebarControlId.Watermarking,S.SidebarPaneId.Watermarking,(function(e){return h.allowWatermarkTrial(l.getCurrentUser(e))})),B=W(S.FileViewerMode.Zoom,S.SidebarControlId.Zoom,S.SidebarPaneId.Zoom),K=W(S.FileViewerMode.Slack,S.SidebarControlId.Slack,S.SidebarPaneId.SlackHome),G=W(S.FileViewerMode.Markup,S.SidebarControlId.Markup,S.SidebarPaneId.Markup),q=function(){},X=function(){};t.overflowZoomOn=function(){return{type:u.Actions.OverflowZoomOn}},t.overflowZoomOff=function(){return{type:u.Actions.OverflowZoomOff}}})),define("modules/clean/react/file_viewer/data/reducer",["require","exports","tslib","modules/clean/react/file_viewer/data/types","modules/clean/react/watermarking/utils","modules/clean/react/file_viewer/constants","file-viewer/core","modules/clean/react/workflows/markup/utils"],(function(e,t,r,i,n,a,o,s){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultState={currentFileId:void 0,currentPageIndex:0,fileRevision:void 0,latestFileId:void 0,forceHideToolbar:!1,isFullScreen:!1,isSidebarOpen:(l={},l[a.DocType.ppt]=!0,l[a.DocType.pdf]=!1,l),mode:o.FileViewerMode.Default,disabledModes:{},renderStatuses:{},showOverQuotaUpsell:void 0,sidebar:{visibility:o.SidebarVisibility.Closed,paneStack:[],selectedControlId:void 0},watermark:n.DEFAULT_WATERMARKING_STATE,markup:s.DEFAULT_MARKUP_STATE,campaign:void 0,overflowZoom:!1},t.fileViewerReducer=function(e,n){var a,l,c,u,d,p,f;switch(void 0===e&&(e=t.defaultState),n.type){case i.Actions.CloseFile:return r.__assign({},e,{currentFileId:void 0,fileRevision:void 0,latestFileId:void 0});case i.Actions.OpenFile:var m=n.payload;return r.__assign({},e,{currentFileId:m.fileId,fileRevision:void 0,latestFileId:void 0});case i.Actions.SwitchRevision:m=n.payload;return r.__assign({},e,{fileRevision:m.file});case i.Actions.RestoreRevision:return r.__assign({},e,{fileRevision:void 0,currentFileId:e.latestFileId||e.currentFileId,latestFileId:void 0});case i.Actions.SetPageDimensions:var _=n.payload.pageDimensions;return r.__assign({},e,{pageDimensions:_});case i.Actions.UpdateWatermarkOptions:var g=n.payload.options;return r.__assign({},e,{watermark:r.__assign({},e.watermark,{textWatermarkingOptions:r.__assign({},e.watermark.textWatermarkingOptions,g.textWatermarkingOptions),imageWatermarkingOptions:r.__assign({},e.watermark.imageWatermarkingOptions,g.imageWatermarkingOptions)})});case i.Actions.SwitchWatermarkingMode:var v=n.payload.mode;return r.__assign({},e,{watermark:r.__assign({},e.watermark,{mode:v})});case i.Actions.SetMarkupCanvas:var w=n.payload,h=w.page,S=w.fabric,b=w.scale;return r.__assign({},e,{markup:r.__assign({},e.markup,(a={},a[h]={scale:b,fabric:S},a))});case i.Actions.UpdateMarkupCanvasScale:var M=n.payload;h=M.page,b=M.scale;return r.__assign({},e,{markup:r.__assign({},e.markup,(l={},l[h]=r.__assign({},e.markup[h],{scale:b}),l))});case i.Actions.ResetMarkupState:return r.__assign({},e,{markup:s.DEFAULT_MARKUP_STATE});case i.Actions.SetMarkupDrawingMode:var E=n.payload.isDrawingMode;return r.__assign({},e,{markup:r.__assign({},e.markup,{isDrawingMode:E})});case i.Actions.SetMarkupFill:var y=n.payload.color;return r.__assign({},e,{markup:r.__assign({},e.markup,{fillColor:y})});case i.Actions.SetMarkupStroke:y=n.payload.color;return r.__assign({},e,{markup:r.__assign({},e.markup,{strokeColor:y})});case i.Actions.SetMarkupSubmenuType:var A=n.payload.formatSubmenu;return r.__assign({},e,{markup:r.__assign({},e.markup,{formatSubmenu:A})});case i.Actions.SaveForwardRevision:m=n.payload;return r.__assign({},e,{latestFileId:m.revisionKey});case i.Actions.UpdateMode:m=n.payload;return r.__assign({},e,{mode:m.mode});case i.Actions.DisableMode:m=n.payload;return r.__assign({},e,{disabledModes:r.__assign({},e.disabledModes,(c={},c[m.mode]=!0,c))});case i.Actions.EnableMode:m=n.payload;return r.__assign({},e,{disabledModes:r.__assign({},e.disabledModes,(u={},u[m.mode]=!1,u))});case i.Actions.OpenFullScreen:return r.__assign({},e,{isFullScreen:!0});case i.Actions.CloseFullScreen:return r.__assign({},e,{isFullScreen:!1});case i.Actions.OpenSidebar:m=n.payload;return r.__assign({},e,{isSidebarOpen:r.__assign({},e.isSidebarOpen,(d={},d[m.type]=!0,d))});case i.Actions.CloseSidebar:m=n.payload;return r.__assign({},e,{isSidebarOpen:r.__assign({},e.isSidebarOpen,(p={},p[m.type]=!1,p))});case i.Actions.DismissAppDownloadInterstitial:return r.__assign({},e,{appDownloadInterstitialDismissed:!0});case i.Actions.SetShowOverQuotaUpsell:m=n.payload;return r.__assign({},e,{showOverQuotaUpsell:m});case i.Actions.UpdateRenderStatus:m=n.payload;return r.__assign({},e,{renderStatuses:r.__assign({},e.renderStatuses,(f={},f[m.fileId]=m.renderStatus,f))});case i.Actions.PlayMedia:return r.__assign({},e,{isMediaPlaying:!0});case i.Actions.PauseMedia:return r.__assign({},e,{isMediaPlaying:!1,pauseCount:e.pauseCount?e.pauseCount+1:1});case i.Actions.ResetStore:return t.defaultState;case i.Actions.UpdateCurrentPageIndex:m=n.payload;return r.__assign({},e,{currentPageIndex:m.currentPageIndex});case i.Actions.ForceHideToolbar:return r.__assign({},e,{forceHideToolbar:!0});case i.Actions.DisableForceHideToolbar:return r.__assign({},e,{forceHideToolbar:!1});case i.Actions.PopSidebarPane:return e.sidebar.paneStack.length<1?e:r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{paneStack:e.sidebar.paneStack.slice(0,-1)})});case i.Actions.PushSidebarPane:m=n.payload;return e.sidebar.paneStack.includes(m.paneId)?e:r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{paneStack:e.sidebar.paneStack.concat([m.paneId])})});case i.Actions.SetSelectedSidebarControlId:m=n.payload;return r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{selectedControlId:m.controlId})});case i.Actions.ResetSidebarPaneStack:return r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{paneStack:[]})});case i.Actions.ResetSelectedSidebarControlId:return r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{selectedControlId:void 0})});case i.Actions.SetSidebarVisibility:m=n.payload;return r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{visibility:m.visibility})});case i.Actions.FetchControllerModeError:return r.__assign({},e,{mode:o.FileViewerMode.Commenting});case i.Actions.SetBestCampaign:m=n.payload;return r.__assign({},e,{campaign:m.campaign});case i.Actions.PageDown:return void 0===(T=e.currentPageIndex)?e:r.__assign({},e,{currentPageIndex:T+1});case i.Actions.PageUp:var T;return void 0===(T=e.currentPageIndex)?e:r.__assign({},e,{currentPageIndex:T-1});case i.Actions.RegisterUser:m=n.payload;return r.__assign({},e,{currentUser:m.user});case i.Actions.SetTrialMode:m=n.payload;return r.__assign({},e,{isTrialMode:m.isTrialMode});case i.Actions.OverflowZoomOn:return r.__assign({},e,{overflowZoom:!0});case i.Actions.OverflowZoomOff:return r.__assign({},e,{overflowZoom:!1});default:return e}}})),define("modules/clean/react/file_viewer/data/selectors",["require","exports","tslib","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/file_store/selectors","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/constants","modules/clean/previews/data/preview_type_util","reselect","external/lodash","modules/clean/react/extensions/data/selectors","modules/clean/react/extensions/client","file-viewer/core"],(function(e,t,r,i,n,a,o,s,l,c,u,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),u=r.__importStar(u),t.getFileViewerState=function(e){return n.getStateAtNamespace(e,i.FILE_VIEWER_NAMESPACE_KEY)},t.getIsFullScreen=function(e){return t.getFileViewerState(e).isFullScreen},t.getIsSidebarOpen=function(e){return t.getFileViewerState(e).isSidebarOpen},t.getCurrentPageIndex=function(e){return t.getFileViewerState(e).currentPageIndex},t.getAppDownloadInterstitial=function(e){return t.getFileViewerState(e).appDownloadInterstitialDismissed},t.getCurrentFileId=function(e){return t.getFileViewerState(e).currentFileId},t.getCurrentFile=c.createSelector(u.nthArg(0),t.getCurrentFileId,a.getFile),t.getPastFile=function(e){return t.getFileViewerState(e).fileRevision},t.getCurrentUser=function(e){return t.getFileViewerState(e).currentUser},t.getMode=function(e){return t.getFileViewerState(e).mode},t.getDisabledModes=function(e){return t.getFileViewerState(e).disabledModes},t.getSidebar=function(e){return t.getFileViewerState(e).sidebar},t.getAnnotationAllowed=c.createSelector(t.getMode,(function(e){return e===f.FileViewerMode.Commenting})),t.getIsTrialMode=function(e){return t.getFileViewerState(e).isTrialMode},t.getIsEditMode=function(e){return t.getIsMarkupMode(e)||t.getIsWatermarkingMode(e)},t.getIsWatermarkingMode=function(e){return t.getMode(e)===f.FileViewerMode.Watermarking},t.getIsMarkupMode=function(e){return t.getMode(e)===f.FileViewerMode.Markup},t.getPageDimensions=function(e){return t.getFileViewerState(e).pageDimensions},t.getActiveFile=function(e){return t.getPastFile(e)||t.getCurrentFile(e)},t.getShowOverQuotaUpsell=function(e){return t.getFileViewerState(e).showOverQuotaUpsell};t.getSelectedPromptCampaign=function(e){return t.getFileViewerState(e).campaign},t.getRenderStatusForCurrentFile=function(e){var r=t.getCurrentFileId(e);if(r)return(function(e,r){return t.getFileViewerState(e).renderStatuses[r]})(e,r)},t.getIsMediaPlaying=function(e){return t.getFileViewerState(e).isMediaPlaying},t.getPauseCount=function(e){var r=t.getFileViewerState(e).pauseCount;return r||0},t.getPreviewApiDataForCurrentFile=function(e){var r=t.getCurrentFile(e);return o.getApiDataForFile(e,r).data},t.getIsFlippingEnabled=function(e){var r=t.getPreviewApiDataForCurrentFile(e);return!(t.getIsEditMode(e)||t.getIsMediaPlaying(e)||t.getIsFullScreen(e)&&l.isSsrDoc(r))},t.shouldForceHideToolbar=function(e){return t.getFileViewerState(e).forceHideToolbar},t.getExtensionsEnabled=function(e){var r=t.getActiveFile(e);return!r||!d.fileExtensionsConfigs(e)[r.file_id]||d.fileExtensionsConfigs(e)[r.file_id].displayState!==p.DisplayState.DISABLED},t.isOverflowZoomMode=function(e){return!0===t.getFileViewerState(e).overflowZoom},t.getHelloSignAppActionForFile=function(e,t){return d.getOpenActionsForFile(e,t).filter((function(e){return e.app_id===s.HELLOSIGN_PROD_APP_ID}))[0]}})),define("modules/clean/react/file_viewer/data/store",["require","exports","modules/clean/redux/store","modules/clean/redux/namespaces","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/previews/data/reducer","modules/clean/previews/data/actions","modules/clean/file_store/actions","modules/clean/react/file_viewer/data/actions","modules/clean/react/extensions/data/store"],(function(e,t,r,i,n,a,o,s,l,c,u){"use strict";var d;Object.defineProperty(t,"__esModule",{value:!0}),t.fileViewerReducerMap=((d={})[i.FILE_NAMESPACE_KEY]=n.fileNamespaceReducer,d[i.FILE_VIEWER_NAMESPACE_KEY]=a.fileViewerReducer,d[i.PREVIEW_NAMESPACE_KEY]=o.reducer,d),t.getStoreForFileViewer=function(){return u.getStore(),r.getStoreAndRegisterReducers(t.fileViewerReducerMap)},t.hydrateFileViewerNamespace=function(e,t,r){var i=t.file;i&&e.dispatch(c.openFile(i)),r&&e.dispatch(c.registerUser(r))},t.hydrateFileStore=function(e,t){e.dispatch(s.populateFilesPreviewData(t)),e.dispatch(l.putFiles(t))},t.updateFileStore=function(e,t){e.dispatch(l.putFiles(t))}})),define("modules/clean/react/file_viewer/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.CloseFile="FileViewer/CloseFile",e.CloseFullScreen="FileViewer/CloseFullScreen",e.CloseSidebar="FileViewer/CloseSidebar",e.DismissAppDownloadInterstitial="FileViewer/DismissAppDownloadInterstitial",e.DisableForceHideToolbar="FileViewer/DisableForceHideToolbar",e.ForceHideToolbar="FileViewer/ForceHideToolbar",e.UpdateMode="FileViewer/UpdateMode",e.DisableMode="FileViewer/DisableMode",e.EnableMode="FileViewer/EnableMode",e.OpenFile="FileViewer/OpenFile",e.OpenFullScreen="FileViewer/OpenFullScreen",e.OpenSidebar="FileViewer/OpenSidebar",e.PageDown="FileViewer/PageDown",e.PageUp="FileViewer/PageUp",e.PauseMedia="FileViewer/PauseMedia",e.PlayMedia="FileViewer/PlayMedia",e.PopSidebarPane="FileViewer/PopSidebarPane",e.PushSidebarPane="FileViewer/PushSidebarPane",e.SetSelectedSidebarControlId="FileViewer/SetSelectedSidebarControlId",e.ResetSidebarPaneStack="FileViewer/ResetSidebarPaneStack",e.ResetSelectedSidebarControlId="FileViewer/ResetSelectedSidebarControlId",e.ResetStore="FileViewer/ResetStore",e.UpdateCurrentPageIndex="FileViewer/UpdateCurrentPageIndex",e.RestoreRevision="FileViewer/RestoreRevision",e.SaveForwardRevision="FileViewer/SaveForwardRevision",e.SetCurrentCalloutType="FileViewer/SetCurrentCalloutType",e.SetShowOverQuotaUpsell="FileViewer/SetShowOverQuotaUpsell",e.SetSidebarVisibility="FileViewer/SetSidebarVisibility",e.SetPageDimensions="FileViewer/SetPageDimensions",e.UpdateWatermarkOptions="FileViewer/UpdateWatermarkOptions",e.SwitchWatermarkingMode="FileViewer/SwitchWatermarkingMode",e.SetMarkupCanvas="FileViewer/SetMarkupCanvas",e.UpdateMarkupCanvasScale="FileViewer/UpdateMarkupCanvasScale",e.ResetMarkupState="FileViewer/ResetMarkupState",e.SetMarkupDrawingMode="FileViewer/SetMarkupDrawingMode",e.SetMarkupFill="FileViewer/SetMarkupFill",e.SetMarkupStroke="FileViewer/SetMarkupStroke",e.SetMarkupSubmenuType="FileViewer/SetMarkupSubmenuType",e.SwitchRevision="FileViewer/SwitchRevision",e.UpdateRenderStatus="FileViewer/UpdateRenderStatus",e.RegisterUser="FileViewer/RegisterUser",e.SetTrialMode="FileViewer/SetTrialMode",e.FetchControllerModeRequest="FileViewer/FetchControllerModeRequest",e.FetchControllerModeSuccess="FileViewer/FetchControllerModeSuccess",e.FetchControllerModeError="FileViewer/FetchControllerModeError",e.FetchBestCampaign="FileViewer/FetchBestCampaign",e.SetBestCampaign="FileViewer/SetBestCampaign",e.OverflowZoomOn="FileViewer/OverflowZoomOn",e.OverflowZoomOff="FileViewer/OverflowZoomOff"})(t.Actions||(t.Actions={}))})),define("modules/clean/react/file_viewer/file_preview_event_emitter",["require","exports","tslib","eventemitter3"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.filePreviewEventEmitter=new i.default})),define("modules/clean/react/file_viewer/location_utils",["require","exports","tslib","modules/clean/react/file_viewer/constants","modules/clean/history","modules/core/exception"],(function(e,t,r,i,n,a){"use strict";function o(e,t){if(e&&!(t<=0))return e.split("/").slice(0,t+1).join("/")}function s(e,t){var r=n.default.get_uri();return t?r.updateQuery(e,t):r.removeQuery(e),r}function l(e){n.default.push_state(e.getPath(),e.getQuery())}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),a=r.__importStar(a),t.getFilenameFromLocation=function(e){return e?e.query.preview:""},t.addToFileSubpath=function(e,t){return e?e+"/"+t:"/"+t},t.truncateFileSubpath=o,t.shortenFileSubpathBy=function(e,t){if(e){if(t<=0)return e;var r=e.split("/");return o(e,r.length-t-1)}},t.updateFileSubpathQuery=function(e){l(s(i.SubpathQueryKey,e))},t.getFileSubpath=function(e){var t,r=e.query[i.SubpathQueryKey];if(!(t=r instanceof Array?r.length?r[0]:void 0:r)||0===t.indexOf("/"))return t;a.reportStack("path malformed",{severity:a.SEVERITY.NONCRITICAL,exc_extra:{fileSubpath:t}})},t.getPageQuery=function(e){var t=e.query[i.PageQueryKey];if(t){var r=+t;return r||void 0}},t.updatePageQuery=function(e){e?e>0&&l(s(i.PageQueryKey,e.toString())):l(s(i.PageQueryKey,null))}})),define("modules/clean/react/file_viewer/logging",["require","exports","modules/clean/react/file_viewer/models","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants"],(function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUserAction=function(e,t,a){void 0===a&&(a={}),null!=r.FilePreviewSession.currentSession&&i.filePreviewEventEmitter.emit(n.EventType.FilePreviewUserAction,r.FilePreviewSession.currentSession,e,t,a)},t.wrapToolbarActionWithLogging=function(e,r){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=e.apply(void 0,i);return t.logUserAction(r,n.UserActionContext.Toolbar),o}},t.wrapKeyboardActionWithLogging=function(e,r){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=e.apply(void 0,i);return t.logUserAction(r,n.UserActionContext.Keyboard),o}}})),define("modules/clean/react/file_viewer/models",["require","exports","tslib","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/previews/constants","modules/clean/uuid","modules/clean/web_timing_logger","modules/core/browser","modules/core/browser_detection","modules/core/exception"],(function(e,t,r,i,n,a,o,s,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l),u=r.__importStar(u);var d={};d[i.EventType.FilePreviewAttemptStarted]=null,d[i.EventType.FilePreviewSupportConfirmed]=i.EventType.FilePreviewAttemptStarted,d[i.EventType.FilePreviewSupportDenied]=i.EventType.FilePreviewAttemptStarted,d[i.EventType.FilePreviewDownloadAttempted]=i.EventType.FilePreviewSupportConfirmed,d[i.EventType.FilePreviewDownloadSucceeded]=i.EventType.FilePreviewDownloadAttempted,d[i.EventType.FilePreviewDownloadFailed]=i.EventType.FilePreviewDownloadAttempted,d[i.EventType.FilePreviewRenderSucceeded]=i.EventType.FilePreviewDownloadSucceeded,d[i.EventType.FilePreviewRenderFailed]=i.EventType.FilePreviewDownloadSucceeded;var p=(function(){function e(e){this.id=e||o.UUID.v4({allowInsecure:!0}),this.deviceType=this._deviceTypeString()}return e.prototype._deviceTypeString=function(){return c.is_supported_mobile_browser()?"mobile":c.is_tablet()?"tablet":"desktop"},e.currentSession=null,e})();t.FileViewerSession=p;var f=(function(){function e(e){var t=e.id,r=e.fileViewerSession,i=e.file,n=e.previewType,a=e.sourceContext,s=e.sourceAction;this.passwordNeeded=!1,u.assert(!!r,"FileViewerSession required"),u.assert(!!i,"File required"),this.id=t||o.UUID.v4({allowInsecure:!0}),this.fileViewerSession=r,this.file=i,this.previewType=n,this.sourceContext=a,this.sourceAction=s,this.previewTimeline={},this.lastEvent=null}return e.prototype.recordEvent=function(e,t){if(void 0===t&&(t={}),!(t instanceof Object))throw new Error("extra param of recordEvent should be an object.");this.isEventInTimeline(e)||d.hasOwnProperty(e)&&this.lastEvent!==d[e]||(this.addToTimeline(e),n.filePreviewEventEmitter.emit(e,this,t),this.lastEvent=e)},e.prototype.markPrimaryEvent=function(){var e;e=window._timingData&&window._timingData.tti?window._timingData.tti.getTime():l.now(),this.primaryMarkTs||(this.primaryMarkTs=e)},e.prototype.timeToPrimaryMark=function(){return this.timeToMark(this.primaryMarkTs)},e.prototype.timeToMark=function(e){if(void 0!==e)switch(this.sourceAction){default:return;case a.PreviewSourceAction.Visit:var t=s.start_time();return void 0!==t?e-t:void 0;case a.PreviewSourceAction.Click:var r=this.previewTimeline[i.EventType.FilePreviewAttemptStarted];if(!r)return;var n=r.timestamp;if(void 0===n)return;return e-n}},e.prototype.isEventInTimeline=function(e){return e in this.previewTimeline},e.prototype.addToTimeline=function(e){this.previewTimeline[e]={timestamp:l.now()}},e.currentSession=null,e})();t.FilePreviewSession=f})),define("modules/clean/react/file_viewer/open_button/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.DOWNLOAD=0]="DOWNLOAD",e[e.UNITY_FILE=1]="UNITY_FILE",e[e.UNITY_FOLDER=2]="UNITY_FOLDER",e[e.OPEN_WITH=3]="OPEN_WITH",e[e.OPEN_IN_PAPER=4]="OPEN_IN_PAPER",e[e.APP_ACTION=5]="APP_ACTION",e[e.PREPARE_FOR_SIGNATURE=6]="PREPARE_FOR_SIGNATURE",e[e.SHARE_TO_SLACK=7]="SHARE_TO_SLACK",e[e.PRESENT_IN_ZOOM=8]="PRESENT_IN_ZOOM",e[e.SHARE_TO_TRELLO=9]="SHARE_TO_TRELLO",e[e.INVITE_VIA_EMAIL=10]="INVITE_VIA_EMAIL",e[e.OPEN_WITH_CLOUD_DOC=11]="OPEN_WITH_CLOUD_DOC",e[e.OPEN_MORE_APPS=12]="OPEN_MORE_APPS",e[e.OPEN_ADD_APPS=13]="OPEN_ADD_APPS"})(t.OpenButtonAction||(t.OpenButtonAction={}))})),define("modules/clean/react/file_viewer/prompt/campaign_api",["require","exports","modules/clean/api_v2/user_client"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchBestCampaigns=function(e,t){var i={client_context:{platform:"web",locations:["targeted_bubble"],ref_page:["preview","file_viewer"],display_context:"fv_preview_type="+t}};return(new r.UserApiV2Client).ns("prompt").rpc("get_best_campaigns",i,{subjectUserId:e})}})),define("modules/clean/react/file_viewer/title_utils",["require","exports","modules/constants/python","modules/clean/filepath","modules/clean/file_store/utils","modules/core/i18n"],(function(e,t,r,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closeButtonTitle=function(e){var t=(function(e){var t=e.file,o=e.fileViewAction,s=e.fileViewOrigin;return e.isVersionHistoryMode?a._("Version history"):s===r.FileViewOriginType.RECENTS?a._("Recents"):s===r.FileViewOriginType.HOME?a._("Home"):s!==r.FileViewOriginType.PHOTOS&&o!==r.FileViewActionType.SEARCH&&n.isBrowseFile(t)&&t.fq_path?i.filename(i.parent_dir(t.fq_path)):void 0})(e);return!e.sharedLinkInfo&&t?a._("Back to %(folder)s").format({folder:t}):a._("Close")},t.customLogoUrl=function(e){return e?e.ownerTeamLogo:void 0}})),define("modules/clean/react/file_viewer/url_utils",["require","exports","tslib","modules/clean/history","modules/core/browser"],(function(e,t,r,i,n){"use strict";function a(e){i.default.push_state(e.getPath(),e.getQuery())}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importStar(n),t.linkClickHandler=function(e){return function(t){t.ctrlKey||t.metaKey||e(t)}},t.getCurrentFolderHref=function(){var e=n.get_uri();return e.removeQuery("preview"),e},t.closeFile=function(){var e,t;e="preview",(t=i.default.get_uri()).removeQuery(e),a(t)},t.openFile=function(e){(function(e,t){var r={};r[e]=t;var n=i.default.get_uri();n.updateQuery(r),a(n)})("preview",e.filename)}})),define("modules/clean/react/location/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e,t){void 0===t&&(t={}),this.path=e,this.query=t}return e.fromURI=function(t){return new e(t.getPath(),t.getQuery())},e})();t.Location=r})),define("modules/clean/react/location/with_location",["require","exports","tslib","react","modules/clean/react/location/types","modules/core/browser","modules/clean/history","modules/clean/react/helpers"],(function(e,t,r,i,n,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),a=r.__importStar(a),o=r.__importDefault(o);var l=function(e){return{location:e}};t.withLocation=function(e,t){var c;return void 0===t&&(t=l),(c=(function(s){function l(e){var r=s.call(this,e)||this;r.onLocationChange=function(e,i){r.setState(t(new n.Location(r.basePathComponent+"/"+decodeURIComponent(e),i),r.props))};var i=a.get_uri(),o=i.getPath();return r.basePathComponent="/"+o.split("/")[1],r.state=t(n.Location.fromURI(i),e),r}return r.__extends(l,s),l.prototype.componentDidMount=function(){o.default.add_callback(this.basePathComponent,this.onLocationChange,!0)},l.prototype.componentWillUnmount=function(){o.default.remove_callback(this.basePathComponent,this.onLocationChange)},l.prototype.render=function(){return i.default.createElement(e,r.__assign({},this.props,this.state))},l})(i.default.PureComponent)).displayName="WithLocation("+s.getDisplayName(e)+")",c}})),define("modules/clean/react/open_in_app/banner",["require","exports","tslib","react","modules/clean/react/css","modules/clean/open_in_app/actions","modules/core/i18n"],(function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={closed:!1,showInstallAppText:!1},t.handleAppRedirect=function(){t.props.onClick&&t.props.onClick(),a.openInApp(t.props.urls,{onAppNeeded:function(){return t.setState({showInstallAppText:!0})},onAppInstalled:function(){return t.setState({showInstallAppText:!1})}})},t.dismiss=function(){t.setState({closed:!0});var e=t.props.onClose;e&&e()},t}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){a.cleanUp()},t.prototype.render=function(){var e=this.state,t=e.closed,r=e.showInstallAppText;return t?null:i.default.createElement("div",{className:"open-in-app-banner-container"},i.default.createElement("button",{className:"button-as-link open-in-app-banner-text",onClick:this.handleAppRedirect},r?o._("Get the Dropbox App"):o._("View In App")),i.default.createElement("button",{className:"button-as-link open-in-app-banner-close","aria-label":"Close",onClick:this.dismiss}))},t})((i=r.__importDefault(i)).default.Component),l=n.requireCssWithComponent(s,["/static/css/open_in_app/banner-vfl1xt3Tn.css"]);t.OpenInAppBanner=l})),define("modules/clean/react/size_class/size_class",["require","exports","tslib","react","classnames","hoist-non-react-statics","spectrum/match","modules/clean/react/size_class/constants","modules/clean/react/helpers"],(function(e,t,r,i,n,a,o,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importDefault(n),a=r.__importDefault(a),t.SizeClass=s.SizeClass,t.withSizeClass=function(e,t){void 0===t&&(t={});var c=(function(a){function c(t){var r=a.call(this,t)||this;return r.displayName="WithSizeClass("+l.getDisplayName(e),r.onMatchSmall=function(){return r.setState({sizeClass:s.SizeClass.Small})},r.onMatchMedium=function(){return r.setState({sizeClass:s.SizeClass.Medium})},r.onMatchLarge=function(){return r.setState({sizeClass:s.SizeClass.Large})},r.onMatchExtraLarge=function(){return r.setState({sizeClass:s.SizeClass.ExtraLarge})},window.matchMedia(s.MEDIA_SIZE_CLASS_EXTRA_LARGE).matches?r.state={sizeClass:s.SizeClass.ExtraLarge}:window.matchMedia(s.MEDIA_SIZE_CLASS_LARGE).matches?r.state={sizeClass:s.SizeClass.Large}:window.matchMedia(s.MEDIA_SIZE_CLASS_MEDIUM).matches?r.state={sizeClass:s.SizeClass.Medium}:r.state={sizeClass:s.SizeClass.Small},r}return r.__extends(c,a),c.prototype.render=function(){var a,l=t.isResponsiveEnabled,c=t.responsiveClassName,u=void 0===c?"":c,d=!l||l();return i.default.createElement("div",{className:n.default((a={},a[u]=d,a))},i.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_SMALL,onMatch:this.onMatchSmall}),i.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_MEDIUM,onMatch:this.onMatchMedium}),i.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_LARGE,onMatch:this.onMatchLarge}),i.default.createElement(o.Match,{media:s.MEDIA_SIZE_CLASS_EXTRA_LARGE,onMatch:this.onMatchExtraLarge}),i.default.createElement(e,r.__assign({},this.props,{sizeClass:d?this.state.sizeClass:s.SizeClass.Large})))},c})(i.default.Component);return a.default(c,e)}})),define("modules/clean/react/size_class/utils",["require","exports","modules/clean/react/size_class/constants"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSmallerThanLarge=function(e){return e!==r.SizeClass.Large&&e!==r.SizeClass.ExtraLarge}})),define("modules/clean/react/watermarking/drawing",["require","exports"],(function(e,t){"use strict";function r(e,t,r,i,n){void 0===n&&(n=!1),e.save(),e.font=r+"px "+i;var a=e.measureText(t);return e.restore(),n?{width:a.width,height:a.actualBoundingBoxAscent+a.actualBoundingBoxDescent||r}:{width:a.width,height:a.fontBoundingBoxAscent+a.fontBoundingBoxDescent||r}}Object.defineProperty(t,"__esModule",{value:!0}),t.drawTextTile=function(e,t,i,n,a,o){var s=document.createElement("canvas"),l=s.getContext("2d");if(!l)throw new Error("Cannot draw on canvas");var c=r(l,e,t,i),u=c.width,d=c.height;s.width=Math.abs(u*Math.cos(o))+Math.abs(d*Math.sin(o)),s.height=Math.abs(u*Math.sin(o))+Math.abs(d*Math.cos(o)),l.font=t+"px "+i,l.globalAlpha=a,l.fillStyle=n,l.textBaseline="bottom";var p=0,f=s.height;o<.5*Math.PI?p=d*Math.sin(o):o<Math.PI?(p=d*Math.sin(o)-u*Math.cos(o),f+=d*Math.cos(o)):o<1.5*Math.PI?(p=-u*Math.cos(o),f=0):f+=u*Math.sin(o),l.translate(p,f),l.rotate(-o),l.fillText(e,0,0);var m=r(l,e,t,i,!0),_=m.width;return{canvas:s,actualUnrotatedHeight:m.height,actualUnrotatedWidth:_}},t.drawImageTile=function(e,t,r,i){var n=document.createElement("canvas"),a=n.getContext("2d");if(!a)throw new Error("Cannot draw on canvas");var o=i||0,s=e.width*t,l=e.height*t;n.width=Math.round(Math.abs(s*Math.cos(o))+Math.abs(l*Math.sin(o))),n.height=Math.round(Math.abs(s*Math.sin(o))+Math.abs(l*Math.cos(o)));var c=0,u=0;return o<.5*Math.PI?u=s*Math.sin(o):o<Math.PI?(c=-s*Math.cos(o),u=s*Math.sin(o)-l*Math.cos(o)):o<1.5*Math.PI?(c=-s*Math.cos(o)-l*Math.sin(o),u=-l*Math.cos(o)):c=-l*Math.sin(o),a.globalAlpha=r,a.translate(c,u),a.rotate(-o),a.drawImage(e,0,0,s,l),{canvas:n,actualUnrotatedHeight:l,actualUnrotatedWidth:s}}})),define("modules/clean/react/watermarking/selectors",["require","exports","tslib","reselect","external/lodash","modules/clean/react/watermarking/types","modules/clean/react/watermarking/utils","modules/clean/react/watermarking/drawing","modules/clean/react/file_viewer/data/selectors"],(function(e,t,r,i,n,a,o,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.getWatermarkState=function(e){return l.getFileViewerState(e).watermark},t.getWatermarkTilingFunc=i.createSelector(t.getWatermarkState,(function(e){return n.memoize((function(t){var r=a.getWatermarkingOptions(e),i=r.angle,n=r.opacity,l=r.size,c=i%360,u=i/180*Math.PI,d=u%(Math.PI/2),p=(function(r){if(e.mode===a.WatermarkingMode.TEXT){var i=e.textWatermarkingOptions,c=i.color,u=i.fontFamily,d=i.text;return s.drawTextTile(d,l*t,u,c,n/100,r)}var p=e.imageWatermarkingOptions.image;if(!p)throw new o.WatermarkingError(o.WatermarkingError.TILE_NO_INPUT);return s.drawImageTile(p,l*t,n/100,r)})(u),f=p.canvas,m=p.actualUnrotatedHeight,_=p.actualUnrotatedWidth,g=Math.max(m,_),v=g/2,w=g/2;e.mode===a.WatermarkingMode.TEXT&&(v=2*m,w=e.textWatermarkingOptions.lineHeight*m);var h=_+v,S=m+w,b=0,M=0,E=0;return c%180==0?(b=h,M=S,E=v/-1.2):c%180==90?(b=S,M=h):c>0&&c<90||c>180&&c<270?(b=S/Math.sin(d),M=h*Math.sin(d),E=-h*Math.cos(d)):(c>90&&c<180||c>270&&c<360)&&(b=S/Math.cos(d),M=h*Math.cos(d),E=h*Math.sin(d)),{canvas:f,width:f.width,height:f.height,distanceX:b,distanceY:M,startX:-f.width/2,startY:-f.height/2,offsetXPerRow:E,offsetYPerCol:0}}))}))})),define("modules/clean/react/watermarking/types",["require","exports"],(function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.TEXT="text",e.IMAGE="image"})(r=t.WatermarkingMode||(t.WatermarkingMode={})),(function(e){e.REPEAT="REPEAT",e.CENTER="CENTER",e.NORTHWEST="NORTHWEST",e.NORTHEAST="NORTHEAST",e.SOUTHEAST="SOUTHEAST",e.SOUTHWEST="SOUTHWEST"})(t.WatermarkPosition||(t.WatermarkPosition={})),t.getWatermarkingOptions=function(e){return e.mode===r.TEXT?e.textWatermarkingOptions:e.imageWatermarkingOptions}})),define("modules/clean/react/watermarking/utils",["require","exports","tslib","sjcl","external/lodash","modules/constants/file_viewer","modules/clean/i18n/formatters","modules/constants/page_load","modules/clean/file_store/utils","modules/core/i18n","modules/clean/previews/constants","modules/clean/react/watermarking/drawing","modules/clean/react/watermarking/types","modules/clean/storage","modules/core/cookies","modules/core/exception","modules/clean/react/user_metadata/api"],(function(e,t,r,i,n,a,o,s,l,c,u,d,p,f,m,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importStar(n),_=r.__importStar(_);var v=c.i18n_default_project("watermarking")._,w=[".pdf",".jpg",".jpeg",".png",".bmp"];t.DEFAULT_SIZES={size:1,minSize:.2,maxSize:5},t.WATERMARKING_LOCAL_STORAGE_KEY="fileviewer_watermarking_data";var h=(function(e){function t(t){var r=e.call(this,t)||this;return r.message=t,r.name="WatermarkingError",r}return r.__extends(t,e),t.TILE_NO_INPUT="Unable to tile: missing text or image",t})(Error);function S(e){return e&&a.WATERMARK_TRIAL_VARIANT_BY_USER_ID?a.WATERMARK_TRIAL_VARIANT_BY_USER_ID[e.id]:""}function b(e){return!t.isWatermarkingEnabled(e)&&["DEACTIVATED_MENU","POPOVER_WM_VALUE_PROPS","POPOVER_PRO_VALUE_PROPS","TOOLTIP_ON_HOVER"].includes(S(e))}function M(e){return new Promise((function(t,r){var i=new Image;i.onload=function(){t(i)},i.onerror=function(e){r(e)},i.crossOrigin="anonymous",i.src=e}))}function E(e){var t;try{var r=i.codec.utf8String.toBits(m.Cookies.read("__Host-js_csrf"));t=i.encrypt(r,JSON.stringify(e))}catch(e){_.reportException({err:e,severity:_.SEVERITY.NONCRITICAL,tags:["watermarking"]})}return t}t.WatermarkingError=h,t.fileIsWatermarkable=function(e){return!!e&&(l.isBrowseFile(e)&&!e.read_only&&!!e.ext&&w.includes(e.ext.toLowerCase()))},t.isWatermarkingEnabled=function(e){return!!(e&&a.WATERMARKING_BY_USER_ID&&a.WATERMARKING_BY_USER_ID[e.id])},t.allowWatermark=function(e,r){return t.isWatermarkingEnabled(r)&&t.fileIsWatermarkable(e)},t.getWatermarkTrialVariant=S,t.allowWatermarkTrial=b,t.allowWatermarkOrTrial=function(e,r){return t.allowWatermark(e,r)||b(r)},t.getDefaultText=function(e){if(!e)return"DRAFT";var t=(0,o.createFormatters(s.USER_LOCALE,{}).formatDate)(new Date,{});return e.display_name+" | "+t},t.getImageDefaultSizes=function(e,r){if(!e||!r)return t.DEFAULT_SIZES;var i=e.width/r.width,n=e.height/r.height,a=Math.max(i,n);if(a*t.DEFAULT_SIZES.maxSize<=.9)return t.DEFAULT_SIZES;var o=.9/a;return{size:o/5,minSize:o/25,maxSize:o}},t.DEFAULT_WATERMARKING_STATE={mode:p.WatermarkingMode.TEXT,textWatermarkingOptions:{angle:45,color:"black",opacity:30,fontFamily:"Helvetica, sans-serif",size:20,minSize:5,maxSize:200,lineHeight:3,text:"DRAFT",position:p.WatermarkPosition.REPEAT,marginX:40,marginY:40,scale:1},imageWatermarkingOptions:r.__assign({angle:45,opacity:30,position:p.WatermarkPosition.REPEAT,marginX:40,marginY:40,scale:1},t.DEFAULT_SIZES)},t.getWatermarkScale=function(e){return e===u.PreviewType.SsrDoc?300/72:1},t.getWatermarkingLabelText=function(e,t){if(e)return t===u.PreviewType.Image?v("Watermarking is available on PDFs, PNGs, JPEGs, and BMPs."):v("Watermarking is available on PDFs and images.")},t.getImageFromURL=M,t.getWatermarkMilestone=function(e){return"M2"},t.setLocalStorageWatermarkingState=function(e,i){return r.__awaiter(this,void 0,void 0,(function(){var n,a;return r.__generator(this,(function(o){if(e&&i){(n=r.__assign({},i,{imageWatermarkingOptions:r.__assign({},i.imageWatermarkingOptions)})).imageWatermarkingOptions.image&&!n.imageWatermarkingOptions.imageAsDataURL&&(n.imageWatermarkingOptions.imageAsDataURL=d.drawImageTile(n.imageWatermarkingOptions.image,1,1).canvas.toDataURL()),delete n.imageWatermarkingOptions.image,a=E(n);try{f.UserLocalStorage.set(e.id,t.WATERMARKING_LOCAL_STORAGE_KEY,a)}catch(r){if(n.imageWatermarkingOptions.imageAsDataURL){delete n.imageWatermarkingOptions.imageAsDataURL,a=E(n);try{f.UserLocalStorage.set(e.id,t.WATERMARKING_LOCAL_STORAGE_KEY,a)}catch(e){_.reportException({err:r,severity:_.SEVERITY.NONCRITICAL,tags:["watermarking"]})}}}}return[2]}))}))},t.getLocalStorageWatermarkingState=function(e){return r.__awaiter(this,void 0,void 0,(function(){var n,a,o,s,l;return r.__generator(this,(function(r){switch(r.label){case 0:if(!(n=f.UserLocalStorage.get(e.id,t.WATERMARKING_LOCAL_STORAGE_KEY)))return[3,5];r.label=1;case 1:return r.trys.push([1,4,,5]),a=i.codec.utf8String.toBits(m.Cookies.read("__Host-js_csrf")),(o=JSON.parse(i.decrypt(a,n))).imageWatermarkingOptions.imageAsDataURL?(s=o.imageWatermarkingOptions,[4,M(o.imageWatermarkingOptions.imageAsDataURL)]):[3,3];case 2:s.image=r.sent(),r.label=3;case 3:return[2,o];case 4:return l=r.sent(),_.reportException({err:l,severity:_.SEVERITY.NONCRITICAL,tags:["watermarking"]}),[3,5];case 5:return[2]}}))}))},t.getUserMetadataTextWatermarkingState=function(e){return r.__awaiter(this,void 0,Promise,(function(){var t,i,a;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,g.getUserMetadata(["TEXT_WATERMARKING_COLOR","TEXT_WATERMARKING_TEXT","TEXT_WATERMARKING_OPACITY","TEXT_WATERMARKING_ANGLE","TEXT_WATERMARKING_POSITION","TEXT_WATERMARKING_SIZE"],e.id)];case 1:return t=r.sent(),i={color:t.TEXT_WATERMARKING_COLOR?t.TEXT_WATERMARKING_COLOR:void 0,text:t.TEXT_WATERMARKING_TEXT,opacity:t.TEXT_WATERMARKING_OPACITY,angle:t.TEXT_WATERMARKING_ANGLE,position:t.TEXT_WATERMARKING_POSITION?t.TEXT_WATERMARKING_POSITION:void 0,size:t.TEXT_WATERMARKING_SIZE},[2,n.omitBy(i,n.isUndefined)];case 2:return a=r.sent(),_.reportException({err:a,severity:_.SEVERITY.NONCRITICAL,tags:["watermarking"]}),[2];case 3:return[2]}}))}))},t.setUserMetadataTextWatermarkingState=function(e,t){var r=t.textWatermarkingOptions;g.setUserMetadata({TEXT_WATERMARKING_COLOR:r.color,TEXT_WATERMARKING_TEXT:r.text,TEXT_WATERMARKING_OPACITY:r.opacity,TEXT_WATERMARKING_ANGLE:r.angle,TEXT_WATERMARKING_POSITION:r.position,TEXT_WATERMARKING_SIZE:r.size},e.id)},t.isOverQuotaError=function(e){return!(!e||"over_quota_error"!==e[".tag"])},t.isFilesystemError=function(e){return!(!e||"filesystem_error"!==e[".tag"])},t.isUnsupportedFileError=function(e){return!(!e||"unsupported_file_error"!==e[".tag"])},t.isUnauthorizedAccessError=function(e){return!(!e||"unauthorized_access"!==e[".tag"])}})),define("modules/clean/react/workflows/markup/fabric_wrapper",["require","exports","tslib","fabric"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(i=r.__importDefault(i)).default.fabric||i.default;t.fabric=n})),define("modules/clean/react/workflows/markup/fabric",["require","exports","tslib","modules/clean/react/workflows/markup/fabric_wrapper","modules/clean/previews/constants","modules/clean/react/workflows/markup/types","modules/clean/api_v2/user_client"],(function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.fabric.Object&&(i.fabric.util.object.extend(i.fabric.Object.prototype,{cornerStyle:"circle",cornerColor:"#0052D9",cornerSize:10,cornerStrokeColor:"white",transparentCorners:!1,drawControls:function(e,t){t=t||{};var r=this._calculateCurrentDimensions(),i=r.x,n=r.y,a=t.cornerSize||this.cornerSize,o=-(i+a)/2,s=-(n+a)/2,l=void 0!==t.transparentCorners?t.transparentCorners:this.transparentCorners,c=void 0!==t.hasRotatingPoint?t.hasRotatingPoint:this.hasRotatingPoint,u=l?"stroke":"fill";return e.save(),e.strokeStyle=e.fillStyle=t.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=t.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,t.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",e,u,o,s,t),this._drawControl("tr",e,u,o+i,s,t),this._drawControl("bl",e,u,o,s+n,t),this._drawControl("br",e,u,o+i,s+n,t),c&&this._drawControl("mtr",e,u,o+i/2,s-this.rotatingPointOffset,t),e.restore(),this},_findTargetCorner:function(e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var t=e.x,r=e.y;for(var i in this.__corner=0,this.oCoords)if(this.isControlVisible(i)&&("mtr"!==i||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==i&&"mr"!==i&&"mb"!==i&&"ml"!==i)){var n=void 0;switch(i){case"mt":n=this._getHorizontalImageLines(this.oCoords.tl.corner,this.oCoords.tr.corner);break;case"mr":n=this._getVerticalImageLines(this.oCoords.tr.corner,this.oCoords.br.corner);break;case"mb":n=this._getHorizontalImageLines(this.oCoords.bl.corner,this.oCoords.br.corner);break;case"ml":n=this._getVerticalImageLines(this.oCoords.tl.corner,this.oCoords.bl.corner);break;default:n=this._getImageLines(this.oCoords[i].corner)}var a=this._findCrossPoints({x:t,y:r},n);if(0!==a&&a%2==1)return this.__corner=i,i}return!1},_getHorizontalImageLines:function(e,t){return{topline:{o:e.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:e.bl},leftline:{o:e.bl,d:e.tl}}},_getVerticalImageLines:function(e,t){return{topline:{o:e.tl,d:e.tr},rightline:{o:e.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:e.tl}}}}),i.fabric.util.object.extend(i.fabric.Canvas.prototype,{uniScaleKey:null,_getActionFromCorner:function(e,t,r){if(!t||!e)return"drag";switch(t){case"mtr":return"rotate";case"ml":case"mr":return r.shiftKey?"scale":"scaleX";case"mt":case"mb":return r.shiftKey?"scale":"scaleY";default:return"scale"}}})),i.fabric.BaseBrush&&(l(a.MarkupColor.RED_CHERRY),i.fabric.BaseBrush.prototype.width=3);var s={strokeUniform:!0,strokeWidth:3,stroke:"red"};function l(e){i.fabric.BaseBrush&&(i.fabric.BaseBrush.prototype.color=e)}function c(e){return e&&"group"===e.type}function u(e){return e&&"i-text"===e.type}t.addMarkupObject=function(e,t,n){var o;switch(t){case a.MarkupType.TEXT:o=new i.fabric.IText("Text",r.__assign({},s,{fontSize:22},n,{fill:n.stroke,stroke:void 0}));break;case a.MarkupType.CIRCLE:o=new i.fabric.Circle(r.__assign({},s,{radius:50,fill:void 0},n));break;case a.MarkupType.RECT:o=new i.fabric.Rect(r.__assign({},s,{width:100,height:100,fill:void 0},n));break;case a.MarkupType.ARROW:var l=n.left,c=n.top,u=n.stroke,d=[l,c+100,l+100,c],p=180*Math.atan2(100,100)/Math.PI,f=new i.fabric.Triangle(r.__assign({},s,{angle:p,top:d[3],left:d[2]+3,height:15,width:15,originX:"center",originY:"center",stroke:u,fill:u})),m=new i.fabric.Line(d,r.__assign({},s,n));o=new i.fabric.Group([m,f],r.__assign({},s,{lockUniScaling:!0,centeredScaling:!0},n))}o&&(e.add(o),e.setActiveObject(o))},t.setDrawingMode=function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&"object"==typeof e[r]){var i=e[r].fabric;i&&(i.isDrawingMode=t)}},t.setBaseBrushColor=l,t.disposeCanvas=function(e){for(var t in e)e[t].fabric&&e[t].fabric.dispose()},t.saveMarkup=function(e,t,i,a,s){return r.__awaiter(this,void 0,void 0,(function(){var l,c,u,d,p,f,m,_,g,v,w,h;return r.__generator(this,(function(r){for(d in l=new o.UserApiV2Client,c=[],u=s===n.PreviewType.SsrDoc?300/72:1,a)if(a.hasOwnProperty(d)&&"object"==typeof a[d]&&(p=a[d].scale,f=u/p,m=a[d].fabric))for(_=0,g=m.getObjects();_<g.length;_++)v=g[_],w=v.getBoundingRect(),c.push({".tag":"burn_image",image:v.toDataURL({multiplier:f}).split(",",2).pop(),x:Math.round(w.left/p),y:Math.round(w.top/p),page:Number(d)});return h={path:t,should_overwrite:i,burn_objects:c},[2,l.ns("workflows").rpc("markup_file",h,{subjectUserId:e})]}))}))},t.setOptionsForActiveObjects=function(e,t){e&&(e.getActiveObjects().forEach((function(e){u(e)?e.set(r.__assign({},t,{stroke:void 0,fill:t.stroke||e.fill})):c(e)?e.forEachObject((function(e){return e.set(r.__assign({},t,{fill:t.stroke||e.stroke}))})):!(function(e){return e&&"path"===e.type})(e)?e.set(t):e.set(r.__assign({},t,{fill:void 0}))})),e.renderAll())},t.getStroke=function(e){return u(e)?e.fill:c(e)?e.getObjects().filter((function(e){return"line"===e.type}))[0].stroke:"stroke"in e?e.stroke:void 0},t.getFill=function(e){if((function(e){return e&&"circle"===e.type})(e)||(function(e){return e&&"rect"===e.type})(e))return e.fill}})),define("modules/clean/react/workflows/markup/selectors",["require","exports","modules/clean/react/file_viewer/data/selectors"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMarkupState=function(e){return r.getFileViewerState(e).markup}})),define("modules/clean/react/workflows/markup/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.TEXT=0]="TEXT",e[e.CIRCLE=1]="CIRCLE",e[e.RECT=2]="RECT",e[e.ARROW=3]="ARROW",e[e.FREEFORM=4]="FREEFORM"})(t.MarkupType||(t.MarkupType={})),(function(e){e.STROKE="stroke",e.FILL="fill"})(t.FormatSubmenuEntry||(t.FormatSubmenuEntry={})),(function(e){e.TRANSPARENT="transparent",e.RED_CHERRY="#D62C0B",e.ORANGE_TANGERINE="#FF8E21",e.GREEN="#00864C",e.DARK_BLUE="#005DD6",e.ULTRAVIOLET="#813BF6",e.WHITE="white",e.BLACK="black"})(t.MarkupColor||(t.MarkupColor={}))})),define("modules/clean/react/workflows/markup/utils",["require","exports","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/previews/constants","modules/core/i18n","modules/clean/react/workflows/markup/types"],(function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a.i18n_default_project("watermarking")._,l=[".pdf",".jpg",".jpeg",".png",".bmp"];t.OFFSET=10,t.DEFAULT_LEFT=100,t.DEFAULT_TOP=100,t.MOVE_DISTANCE_X=1,t.MOVE_DISTANCE_Y=1,t.fileIsMarkupable=function(e){return!!e&&(i.isBrowseFile(e)&&!e.read_only&&!!e.ext&&l.includes(e.ext.toLowerCase()))};t.userCanMarkup=function(){return["M0"].includes(r.FILE_MARKUP)},t.allowMarkup=function(e){return t.userCanMarkup()&&t.fileIsMarkupable(e)},t.getMarkupLabelText=function(e,t){if(e)return t===n.PreviewType.Image?s("Markup is available on PDFs, PNGs, JPEGs, and BMPs."):s("Markup is available on PDFs and images.")},t.getMarkupErrorMessage=function(e){switch(e[".tag"]){case"over_quota_error":return s("Cant save because your account is full. Upgrade to get more space.");case"filesystem_error":return s("Couldnt save markup. Refresh the page to try again.");case"unsupported_file_error":return s("Cant save. Markup isnt available for this file type.");case"unauthorized_access":return s("You dont have permission to save to this folder.");default:return s("Couldnt save markup. Refresh the page to try again.")}},t.DEFAULT_MARKUP_STATE={isDrawingMode:!1,formatSubmenu:[],strokeColor:o.MarkupColor.RED_CHERRY,fillColor:o.MarkupColor.TRANSPARENT}})),define("modules/clean/react/user_metadata/api",["require","exports","modules/clean/api_v2/user_client","modules/clean/react/user_metadata/util"],(function(e,t,r,i){"use strict";function n(e){var t=i.removeEmptyFields(e),r=i.getUserMetadataKeys(t),n={};return r.forEach((function(e){n[e]=JSON.stringify(t[e])})),n}function a(e){var t=i.getUserMetadataKeys(e.metadata),r={};return t.forEach((function(t){var i=JSON.parse(e.metadata[t]);null!=i&&(r[t]=i)})),r}function o(e,t){return(new r.UserApiV2Client).ns("user_metadata").rpc("user_metadata/get",e,{subjectUserId:t})}function s(e,t){return(new r.UserApiV2Client).ns("user_metadata").rpc("user_metadata/set",e,{subjectUserId:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.getUserMetadata=function(e,t){return o({metadata:e},t).then(a)},t.setUserMetadata=function(e,t){return s({metadata:n(e)},t).then(a)},t.prepareUserMetadataSetArg=n,t.processUserMetadataResult=a,t.fetchUserMetadata=o,t.mutateUserMetadata=s})),define("modules/clean/react/user_metadata/util",["require","exports"],(function(e,t){"use strict";function r(e){return Object.keys(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.pickMetadata=function(e,t){var r={};return e.forEach((function(e){r[e]=t[e]})),r},t.removeEmptyFields=function(e){var t=r(e),i={};return t.forEach((function(t){null!=e[t]&&(i[t]=e[t])})),i},t.getUserMetadataKeys=r})),define("modules/clean/react/previews/preview_toolbar_button",["require","exports","tslib","classnames","react","modules/clean/react/sprite","modules/clean/static_urls","spectrum/icon_document","spectrum/tooltip"],(function(e,t,r,i,n,a,o,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importDefault(n),t.PreviewToolbarButton=function(e){var t=e.className,r=e["data-test"],c=e.disabled,u=e.iconName,d=e.onClick,p=e.spriteGroup,f=e.spriteName,m=e.spectrumIconName,_=e.tooltip;return n.default.createElement("div",{className:i.default(t,"toolbar-button-entry"),"data-test":r},n.default.createElement(l.Tooltip,{positioning:"above",positionOffset:24,tooltipContent:_},n.default.createElement("button",{className:t+"-button","aria-label":_,onClick:d},void 0!==u?n.default.createElement("img",{src:o.static_url("/static/images/previews/toolbar/"+u+".svg"),alt:_,className:i.default({disabled:c})}):void 0!==f?n.default.createElement(a.Sprite,{group:p,name:f,alt:_,className:i.default({disabled:c})}):n.default.createElement(s.IconDocument,{name:m}))))}})),define("spectrum/icon_document",["require","exports","tslib","react","spectrum/icon_templates/stateless","spectrum/svg_icon_bundle","spectrum/icon_document/bundle"],(function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.ICONS=o.ICONS,t.IconDocument=function(e){var t=e.name,r=i.createElement(a.SvgIconBundle,{focusable:"false",icon:o.ICONS[t]});return i.createElement(n.Component,Object.assign({icon:r},e))},t.IconDocument.displayName="IconDocument"})),define("spectrum/icon_document/bundle",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS=JSON.parse('\n    {"date-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M4 4h16v16H4V4zm2 2v12h12V6H6z\\"></path><path d=\\"M5 8h14v2H5zM7 2h2v4H7zM15 2h2v4h-2z\\"></path></g></g>"},"date":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M6 6h20v20H6V6zm2 2v16h16V8H8z\\"></path><path d=\\"M7 11h18v2H7zM11 4h2v4h-2zM19 4h2v4h-2z\\"></path></g></g>"},"signature-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M1 18h22v1H1z\\"></path><path d=\\"M10.874 17.262c-1.33 1.046-1.25 2.246-.297 2.723 1.076.537 2.438-.321 3.206-2.953.226-.774.42-1.509.583-2.205-1.06.632-2.251 1.46-3.492 2.435zm4.589.26c-1.044 3.578-3.487 5.118-5.668 4.028-2.131-1.065-2.317-3.844-.003-5.664 1.857-1.46 3.565-2.6 5.014-3.317.634-4.207-.218-6.501-2.436-6.681-1.374-.111-1.993.459-2.027 1.713-.041 1.48.799 3.57 2.34 5.61l-1.397 1.054c-1.76-2.33-2.746-4.782-2.693-6.713.062-2.246 1.534-3.602 3.918-3.408 3.355.272 4.634 3.065 4.144 7.711 1.236-.31 2.137-.102 2.578.742.211.404.28.842.24 1.308a3.4 3.4 0 0 1-.025.205c1.118-.989 1.885-1.388 2.896-1.103.22.063.432.163.632.299l-.986 1.446a.42.42 0 0 0-.121-.06c-.223-.063-.618.152-1.332.792l-.42.379c-.17.151-.308.267-.442.37-.42.32-.786.5-1.217.5-.758 0-1.248-.545-1.188-1.264a2.4 2.4 0 0 1 .12-.543c.034-.105.181-.524.157-.454.11-.32.166-.532.182-.719a.652.652 0 0 0-.037-.325c.02.04.003.044-.143.053-.287.018-.69.127-1.183.324a38.652 38.652 0 0 1-.903 3.717zM1.381 11.619L2.62 10.38l4.95 4.95-1.238 1.237z\\"></path><path d=\\"M6.377 10.382l1.238 1.236-4.948 4.952-1.238-1.237z\\"></path></g></g>"},"signature":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M3 24h26v1H3z\\"></path><path d=\\"M12.5 23.31c-1.983 1.56-1.857 3.437-.376 4.177 1.643.821 3.682-.464 4.79-4.26.37-1.271.68-2.47.931-3.594-1.6.917-3.43 2.172-5.345 3.678zm6.334.476c-1.423 4.878-4.698 6.942-7.604 5.49-2.828-1.413-3.075-5.094.034-7.538 2.627-2.065 5.04-3.666 7.065-4.65.94-6.089-.293-9.445-3.584-9.712-2.047-.166-3.02.73-3.072 2.607-.058 2.126 1.133 5.09 3.313 7.976l-1.595 1.206c-2.431-3.218-3.79-6.597-3.717-9.237.082-3.012 2.03-4.805 5.233-4.546 4.596.373 6.315 4.295 5.547 10.86 1.785-.52 3.073-.3 3.663.83.273.523.363 1.094.31 1.705a4.971 4.971 0 0 1-.175.925c.12-.105.252-.223.4-.356 1.565-1.402 2.605-1.969 3.947-1.59.285.08.558.21.818.387l-1.126 1.652a.807.807 0 0 0-.235-.114c-.414-.117-1.015.21-2.07 1.155-.07.063-.47.426-.586.529a10.64 10.64 0 0 1-.604.506c-.55.42-1.024.653-1.565.653-.928 0-1.51-.649-1.437-1.524.018-.219.07-.436.158-.71.046-.143.25-.725.217-.63.16-.462.24-.774.265-1.057.023-.255-.008-.449-.09-.605-.063-.122-.828-.083-2.231.498-.3 1.634-.728 3.4-1.279 5.29z\\"></path><path d=\\"M8.293 14.294l1.415 1.414-4.997 5-1.414-1.414z\\"></path><path d=\\"M3.297 15.708l1.414-1.414 5 5-1.414 1.414z\\"></path></g></g>"},"text-small":{"attrs":{"width":"24","height":"24","viewBox":"0 0 24 24"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M4 4h16v16H4V4zm2 2v12h12V6H6z\\"></path><path d=\\"M8 8h8v2H8z\\"></path><path d=\\"M11 9h2v7h-2z\\"></path></g></g>"},"text":{"attrs":{"width":"32","height":"32","viewBox":"0 0 32 32"},"dangerouslySetInnerIconHtml":"<g fill=\\"none\\" fill-rule=\\"evenodd\\"><g fill=\\"#000\\" fill-rule=\\"nonzero\\"><path d=\\"M6 6h20v20H6V6zm2 2v16h16V8H8z\\"></path><path d=\\"M11 11h10v2H11zM15 13h2v8h-2z\\"></path></g></g>"}}\n  ')}));
//# sourceMappingURL=pkg-shared_link_core.min.js-vflypkIlY.map